<!doctype html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
   <html>
      <head>
        <!-- <title>Demo &raquo; Resize &raquo; gridster.js</title> -->
        <script src="../libs/jquery/jquery-2.1.4.min.js"></script>

        <!-- Code for Arduino to Serialport connection -->
         <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.8/p5.min.js"></script>
         <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.8/addons/p5.dom.js"></script>
         <script type="text/javascript" src="../js/arduinoHandler.js"></script>

        <link rel="stylesheet" type="text/css" href="../css/my.css">
      </head>


      <body >
        <div class = "videoFrame" id = "mv">
          <video id="videoQ" autoplay>
            <source src="../footage/MQ_c.mp4">
          </video>
          <video id="videoW" autoplay >
            <source src="../footage/ME_c.mp4">
          </video>
          <video id="videoE" autoplay >
            <source src="../footage/E.mp4">
          </video>
          <video id="videoMQ" autoplay >
            <source src="../footage/MQ.mp4">
          </video>
          <video id="videoMW" autoplay >
            <source src="../footage/MW.mp4">
          </video>
          <video id="videoME" autoplay >
            <source src="../footage/ME.mp4">
          </video>
        </div>
       <div id="footnote"></div>


        <script src="http://popcornjs.org/code/dist/popcorn-complete.min.js"></script>
        <script type="text/javascript">

        var temp; //temp state of QWE


        var videos = new Array(3);
        var Mvideos = new Array(3);
        videos[0] = $("#videoQ");
        videos[1] = $("#videoW");
        videos[2] = $("#videoE");
        Mvideos[0] = $("#videoMQ");
        Mvideos[1] = $("#videoMW");
        Mvideos[2] = $("#videoME");



        videos[2][0].addEventListener('ended', function(e){
            window.location.href='index.html';
        }, false);


        window.addEventListener('keydown',this.doKeyDown,false);
        window.addEventListener('keypress',this.doKeyPress,false);
        window.addEventListener('keyup',this.doKeyUp,false);



        hideAll();
        videos[0].show();
        videos[0].prop("volume",1);
        // videos[1].show();

        var temOpacity = 1;
        // function doKeyPress(e){

   
        //   if (e.keyCode == 103 || e.keyCode == 71 )
        //   {
        //     console.log("called?");
        //     videos[0].show();
        //     videos[1].show();
        //     temOpacity -= 0.1;
        //     videos[0].css("opacity",temOpacity);
        //     videos[1].css("opacity",1-temOpacity);
        //   }
        // }



        function doKeyDown(e){
          console.log(e);
       //for test

          // if (e.keyCode == 80 || e.keyCode == 112 ) // when press P
          // {
          //   window.location.href='index.html';
          // }

          // if (e.keyCode == 77 || e.keyCode == 109) // when press M
          // {
          //   hideAll(false);
          //   Mvideos[temp].show();
          //   Mvideos[temp].prop("volume",1);
          //   return;
          // }

          // if (e.keyCode == 81 || e.keyCode == 113) // when press Q
          // {
          //   temp = 0;
          //   hideAll(true);
          // }else
          // if (e.keyCode == 87 || e.keyCode == 119) // when press W
          // {
          //   temp = 1;
          //   hideAll(true);
          // }else
          // if (e.keyCode == 69 || e.keyCode == 101) // when press E
          // {
          //   temp = 2;
          //   hideAll(true);
          // }
          

        }

        function doKeyUp (e) {
          //M
           if (e.keyCode == 77 || e.keyCode == 109)
           {
              hideAll();
              videos[temp].show();
              // if (temp == "Q")

           }
        }

        function hideAll(isShowtemp) {
          for (var i = videos.length - 1; i >= 0; i--) {
            videos[i].hide();
            videos[i].prop("volume",0);
          };
          for (var i = Mvideos.length - 1; i >= 0; i--) {
            Mvideos[i].hide();
            Mvideos[i].prop("volume",0);
          };

          if (isShowtemp)
          {
            videos[temp].show();
            videos[temp].prop("volume",1);
          }
        }

        </script>

     </body>
   </html>